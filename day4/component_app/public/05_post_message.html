<!DOCTYPE html>
<html>
    <head>
        <script src="./lib/axios.min.js"></script>
        <script src="./lib/vue.js"></script>
        <style>
            ul {
                list-style: none;
            }
        </style>
    </head>
    <body>
        <div id="app">
            <boy></boy>
            <hr/>
            <girl></girl>
        </div>

        <script>
            // events é€šä¿¡, è§£å†³ ä»»æ„ ç»„ä»¶ä¹‹é—´çš„é€šä¿¡
            const events = new Vue();

            Vue.component('boy', {
                template: `
                    <div style="border: solid 5px blue; width: 400px; height: 200px">
                        <input ref="msgBox" /> <button v-on:click="send">å‘é€</button>
                        <ul style="height: 100px; overflow: auto; border: solid 1px red">
                            <li v-for="msg of msg_list" style="height: 30px">
                                <div v-bind:style="{float: msg.sender === 'boy' ? 'right' : 'left'}" >
                                    {{msg.sender === 'boy' ? 'ğŸ‘¦' : 'ğŸ‘±â€â™€ï¸'}}  {{msg.msg}}
                                </div>
                            </li>
                        </ul>
                    </div>
                `,
                data() {
                    return {
                        msg_list: []
                    }
                },
                created() {
                    // ç›‘å¬ 'å¥³æœ‹å‹è¯´'
                    events.$on('å¥³æœ‹å‹è¯´', (msg) => {
                        this.msg_list.push(msg);
                    })
                },
                methods: {
                    send() {
                        let msg = this.$refs.msgBox.value;
                        let msgObj = {
                            msg: msg,
                            sender: 'boy',
                            sendTime: new Date()
                        }
                        this.msg_list.push(msgObj);
                        // å¹¿æ’­ä¸€ä¸ªäº‹ä»¶ 'ç”·æœ‹å‹è¯´'
                        events.$emit('ç”·æœ‹å‹è¯´', msgObj)
                        this.$refs.msgBox.value = '';
                    }
                }
            
            });

            Vue.component('girl', {
                template: `
                    <div style="border: solid 5px pink; width: 400px; height: 200px">
                            <input ref="msgBox" /> <button v-on:click="send">å‘é€</button>
                        <ul style="height: 100px; overflow: auto; border: solid 1px red">
                                <li v-for="msg of msg_list" style="height: 30px">
                                <div v-bind:style="{float: msg.sender === 'girl' ? 'right' : 'left'}" >
                                    {{msg.sender === 'girl' ? 'ğŸ‘±â€â™€ï¸' : 'ğŸ‘¦'}}{{msg.msg}}
                                </div>
                            </li>
                        </ul>
                    </div>
                `,
                data () {
                    return {
                        msg_list: []
                    }
                },
                // ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ, è¡¨ç¤º å½“å‰ç»„ä»¶è¢«åˆ›å»ºå¥½äº†
                created() {
                    // ç›‘å¬ 'ç”·æœ‹å‹è¯´'
                    events.$on('ç”·æœ‹å‹è¯´', (msg) => {
                        this.msg_list.push(msg);
                    })
                },
                methods: {
                    send() {
                        let msg = this.$refs.msgBox.value;
                        let msgObj = {
                            msg: msg,
                            sender: 'girl',
                            sendTime: new Date()
                        }
                        this.msg_list.push(msgObj);
                        // å¹¿æ’­ä¸€ä¸ªäº‹ä»¶ 'å¥³æœ‹å‹è¯´'
                        events.$emit('å¥³æœ‹å‹è¯´', msgObj);
                        this.$refs.msgBox.value = '';
                    }
                }
            });

            new Vue({
                el: '#app',
                data: {
                    
                },
                methods: {
                    
                }
            })
        </script>
    </body>
</html>